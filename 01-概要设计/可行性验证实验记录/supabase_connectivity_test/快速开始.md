# Supabase 连通性测试 - 快速开始

## 步骤 1: 创建测试表

由于直接数据库连接可能受限，请在 Supabase 控制台中手动创建测试表：

1. 登录 [Supabase 控制台](https://app.supabase.com)
2. 选择项目: `euzzmtqrmdlbaanjizlt`
3. 进入 **SQL Editor**
4. 点击 **New query**
5. 复制并执行以下 SQL：

```sql
-- 创建测试表
CREATE TABLE IF NOT EXISTS test_ping (
  id BIGSERIAL PRIMARY KEY,
  test_data TEXT,
  created_at TIMESTAMP DEFAULT NOW()
);

-- 插入一条测试数据
INSERT INTO test_ping (test_data) 
VALUES ('Initial test data')
ON CONFLICT DO NOTHING;

-- 启用 RLS
ALTER TABLE test_ping ENABLE ROW LEVEL SECURITY;

-- 删除现有策略（如果存在）
DROP POLICY IF EXISTS "Allow all read" ON test_ping;
DROP POLICY IF EXISTS "Allow all insert" ON test_ping;
DROP POLICY IF EXISTS "Allow all update" ON test_ping;
DROP POLICY IF EXISTS "Allow all delete" ON test_ping;

-- 允许所有人读取
CREATE POLICY "Allow all read" ON test_ping
  FOR SELECT
  USING (true);

-- 允许所有人插入
CREATE POLICY "Allow all insert" ON test_ping
  FOR INSERT
  WITH CHECK (true);

-- 允许所有人更新
CREATE POLICY "Allow all update" ON test_ping
  FOR UPDATE
  USING (true);

-- 允许所有人删除
CREATE POLICY "Allow all delete" ON test_ping
  FOR DELETE
  USING (true);
```

6. 点击 **Run** 执行 SQL
7. 确认表创建成功

## 步骤 2: 运行测试

表创建完成后，运行测试脚本：

```bash
cd 01-概要设计/可行性验证实验记录/supabase_connectivity_test
source venv/bin/activate
python test_connectivity.py \
  --url https://euzzmtqrmdlbaanjizlt.supabase.co \
  --key eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV1enptdHFybWRsYmFhbmppemx0Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NTAyMTMyMiwiZXhwIjoyMDgwNTk3MzIyfQ.aPtW5w_UyMt4Ma-CqE0yiGcQ6KU79U3sdOWawxi9UAw \
  --table test_ping \
  --num-tests 10 \
  --output test_results.json
```

## 步骤 3: 查看结果

测试完成后，查看：
- 控制台输出的测试结果
- `test_results.json` 文件中的详细数据
- 更新 `实验结果记录.md` 文件

