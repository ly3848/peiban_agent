# 实验四：Supabase 国内连通性验证

## 实验目的

Supabase 的服务器通常在新加坡或美国。需验证国内用户直连数据库（PostgREST）和对象存储（Storage）的速度和稳定性。

## 预期结果

- **API 读写**: < 800ms
- **图片加载**: 100KB 图片 < 1s 显示
- **无丢包**: 请求成功率 > 99%

## 实验配置

### Supabase 项目配置

- **项目名称**: __________
- **项目 URL**: __________
- **Region**: __________ (Singapore / Tokyo / 其他)
- **API Key**: __________ (已配置，不在此记录)

### 测试环境

- **测试时间**: __________
- **测试人员**: __________
- **Python 版本**: __________
- **网络环境**: 
  - [ ] 公司 WiFi
  - [ ] 4G 热点
  - [ ] 5G 热点
  - [ ] 其他: __________

## 实验步骤

1. ✅ 在 Supabase 控制台创建项目（Region 选 Singapore 或 Tokyo）
2. ✅ 创建 test_ping 表，插入 1 条数据
3. ✅ 上传一张 500KB 的图片到 Storage Bucket
4. ✅ 安装依赖: `pip install -r requirements.txt`
5. ✅ 运行测试脚本: `python test_connectivity.py --url XXX --key XXX --table test_ping --bucket XXX --file XXX --num-tests 10`
6. ✅ 记录测试结果

## 实验结果记录

### 域名解析测试

**测试结果**:

- [ ] DNS 解析是否成功: (是/否)
- [ ] 解析到的 IP 地址: __________

---

### 数据库读取测试

**测试时间**: __________

**测试命令**:
```bash
python test_connectivity.py --url <SUPABASE_URL> --key <API_KEY> --table test_ping --num-tests 10 --output results.json
```

**测试结果**:

- [ ] 平均延迟: __________ ms
- [ ] 最小延迟: __________ ms
- [ ] 最大延迟: __________ ms
- [ ] 成功率: __________ %
- [ ] 评估: (优秀/可接受/需要优化)

**详细数据文件**: `results.json`

---

### 数据库写入测试

**测试时间**: __________

**测试结果**:

- [ ] 平均延迟: __________ ms
- [ ] 最小延迟: __________ ms
- [ ] 最大延迟: __________ ms
- [ ] 成功率: __________ %
- [ ] 评估: (优秀/可接受/需要优化)

---

### Storage 下载测试

**测试时间**: __________

**测试配置**:
- Bucket 名称: __________
- 文件路径: __________
- 文件大小: __________ KB

**测试结果**:

- [ ] 平均延迟: __________ ms
- [ ] 最小延迟: __________ ms
- [ ] 最大延迟: __________ ms
- [ ] 成功率: __________ %
- [ ] 评估: (优秀/可接受/需要优化)

---

## 综合评估

### 测试总结

| 测试项 | 平均延迟 | 成功率 | 评估 |
|--------|----------|--------|------|
| 数据库读取 | _____ ms | _____ % | _____ |
| 数据库写入 | _____ ms | _____ % | _____ |
| Storage 下载 | _____ ms | _____ % | _____ |

### 结论

- [ ] **使用 Supabase**: 延迟在可接受范围内，可以直接使用
- [ ] **切换到 MemFire Cloud**: 延迟过高，建议使用国内替代方案
- [ ] **自建代理**: 需要部署国内代理服务器加速
- [ ] **是否需要 CDN**: (是/否)

### 后续行动

1. __________
2. __________
3. __________

### 备注

```
（其他需要记录的信息）
```

---

## 附录：测试数据文件

- `results.json`: 完整测试数据（JSON 格式）

