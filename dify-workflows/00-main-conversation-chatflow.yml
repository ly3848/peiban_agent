app:
  description: AIä¼´ä¾£ä¸»å¯¹è¯æµç¨‹ - Chatflowç®€åŒ–ç‰ˆï¼ˆå®Œæ•´çš„è·¯ç”±+å¯¹è¯å·¥ä½œæµï¼‰
  icon: ğŸ’¬
  icon_background: '#8b5cf6'
  mode: advanced-chat
  name: 00-main-conversation-chatflow
  use_icon_as_answer_icon: false
dependencies:
- current_identifier: null
  type: marketplace
  value:
    marketplace_plugin_unique_identifier: langgenius/siliconflow:0.0.15@65d5382cd2c25d45f3bffc1d20a8433588f9f0d7463eab15d5fad034c6a55c40
kind: app
version: 0.3.0
workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      allowed_file_extensions:
      - .JPG
      - .JPEG
      - .PNG
      - .GIF
      - .WEBP
      - .SVG
      allowed_file_types:
      - image
      allowed_file_upload_methods:
      - local_file
      - remote_url
      enabled: false
      fileUploadConfig:
        audio_file_size_limit: 50
        batch_count_limit: 5
        file_size_limit: 15
        image_file_size_limit: 10
        video_file_size_limit: 100
        workflow_file_upload_limit: 10
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
      number_limits: 3
    opening_statement: ä½ å¥½!æˆ‘æ˜¯ä½ çš„AIä¼´ä¾£,æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—?
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions:
    - æ—©å®‰,ä»Šå¤©æ€ä¹ˆæ ·?
    - æˆ‘æœ€è¿‘æœ‰ç‚¹ç´¯
    - ç»™æˆ‘è®²ä¸ªç¬‘è¯
    - æˆ‘ä»Šå¤©è¢«é¢†å¯¼éª‚äº†
    suggested_questions_after_answer:
      enabled: true
    text_to_speech:
      enabled: false
      language: ''
      voice: ''
  graph:
    edges:
    - data:
        isInIteration: false
        sourceType: start
        targetType: llm
      id: start-to-router
      selected: false
      source: start
      sourceHandle: source
      target: llm-router
      targetHandle: target
      type: custom
    - data:
        isInIteration: false
        sourceType: llm
        targetType: code
      id: router-to-parser
      selected: false
      source: llm-router
      sourceHandle: source
      target: code-parser
      targetHandle: target
      type: custom
    - data:
        isInIteration: false
        sourceType: code
        targetType: if-else
      id: parser-to-branch
      selected: false
      source: code-parser
      sourceHandle: source
      target: route-branch
      targetHandle: target
      type: custom
    - data:
        isInIteration: false
        sourceType: llm
        targetType: if-else
      id: fast-critic-to-check
      selected: false
      source: fast-critic
      sourceHandle: source
      target: fast-check-pass
      targetHandle: target
      type: custom
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: fast-fail-to-retry
      selected: false
      source: fast-check-pass
      sourceHandle: 'false'
      target: fast-simple-chat-retry
      targetHandle: target
      type: custom
    - data:
        isInIteration: false
        sourceType: if-else
        targetType: llm
      id: smart-fail-to-retry
      selected: false
      source: smart-check-quality
      sourceHandle: 'false'
      target: smart-emotional-chat-retry
      targetHandle: target
      type: custom
    - data:
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1762851717554-source-fast-critic-target
      selected: false
      source: '1762851717554'
      sourceHandle: source
      target: fast-critic
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: route-branch-fast-17628518957460-target
      selected: false
      source: route-branch
      sourceHandle: fast
      target: '17628518957460'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 17628518957460-source-1762851717554-target
      selected: false
      source: '17628518957460'
      sourceHandle: source
      target: '1762851717554'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: answer
      id: 1762852159587-source-answer-target
      selected: false
      source: '1762852159587'
      sourceHandle: source
      target: answer
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: variable-aggregator
      id: fast-check-pass-true-1762852689786-target
      selected: false
      source: fast-check-pass
      sourceHandle: 'true'
      target: '1762852689786'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: variable-aggregator
      id: fast-simple-chat-retry-source-1762852689786-target
      selected: false
      source: fast-simple-chat-retry
      sourceHandle: source
      target: '1762852689786'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: variable-aggregator
      id: smart-check-quality-true-1762852689786-target
      selected: false
      source: smart-check-quality
      sourceHandle: 'true'
      target: '1762852689786'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: variable-aggregator
      id: smart-emotional-chat-retry-source-1762852689786-target
      selected: false
      source: smart-emotional-chat-retry
      sourceHandle: source
      target: '1762852689786'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: variable-aggregator
        targetType: llm
      id: 1762852689786-source-1762852159587-target
      selected: false
      source: '1762852689786'
      sourceHandle: source
      target: '1762852159587'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: route-branch-smart-1762853602379-target
      selected: false
      source: route-branch
      sourceHandle: smart
      target: '1762853602379'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1762853602379-source-1762856013247-target
      selected: false
      source: '1762853602379'
      sourceHandle: source
      target: '1762856013247'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1762856013247-source-1762856090070-target
      selected: false
      source: '1762856013247'
      sourceHandle: source
      target: '1762856090070'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: llm
      id: 1762856090070-source-1762856221396-target
      selected: false
      source: '1762856090070'
      sourceHandle: source
      target: '1762856221396'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: if-else
      id: 1762856221396-source-smart-check-quality-target
      selected: false
      source: '1762856221396'
      sourceHandle: source
      target: smart-check-quality
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: if-else
        targetType: llm
      id: route-branch-vip-1762856492549-target
      source: route-branch
      sourceHandle: vip
      target: '1762856492549'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInLoop: false
        sourceType: llm
        targetType: variable-aggregator
      id: 1762856492549-source-1762852689786-target
      selected: false
      source: '1762856492549'
      sourceHandle: source
      target: '1762852689786'
      targetHandle: target
      type: custom
      zIndex: 0
    nodes:
    - data:
        desc: ç”¨æˆ·è¾“å…¥å’Œå¯¹è¯ä¸Šä¸‹æ–‡
        selected: false
        title: å¼€å§‹
        type: start
        variables:
        - label: ç”¨æˆ·ID
          max_length: 100
          options: []
          required: true
          type: text-input
          variable: user_id
        - label: ç”¨æˆ·å
          max_length: 50
          options: []
          required: false
          type: text-input
          variable: user_name
        - label: ä¼´ä¾£å
          max_length: 50
          options: []
          required: false
          type: text-input
          variable: companion_name
        - label: äººæ ¼æè¿°
          max_length: 500
          options: []
          required: false
          type: paragraph
          variable: personality_description
        - label: æ˜¯å¦VIP
          options:
          - 'true'
          - 'false'
          required: true
          type: select
          variable: is_vip
      height: 221
      id: start
      position:
        x: 30
        y: 200
      positionAbsolute:
        x: 30
        y: 200
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: åˆ†æç”¨æˆ·æ„å›¾å¹¶è¾“å‡ºè·¯ç”±å†³ç­–
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-14B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: system-prompt
          role: system
          text: "## ç³»ç»Ÿè§’è‰²\nä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ„å›¾è¯†åˆ«ä¸“å®¶ã€‚ä½ çš„ä»»åŠ¡æ˜¯åˆ†æç”¨æˆ·è¾“å…¥,åˆ¤æ–­åº”è¯¥ç”¨å“ªç§å¤„ç†æ–¹å¼ã€‚\n\n## ä»»åŠ¡\nåˆ†æç”¨æˆ·çš„è¾“å…¥,å¹¶è¾“å‡ºä»¥ä¸‹JSON:\n\
            {\n  \"route\": \"fast|smart|vip\",\n  \"intent\": \"ç®€çŸ­æè¿°ç”¨æˆ·æ„å›¾\",\n  \"\
            confidence\": 0.0-1.0,\n  \"reasoning\": \"ä¸ºä»€ä¹ˆåšè¿™ä¸ªåˆ¤æ–­\"\n}\n\n## è·¯ç”±è§„åˆ™ (ä¼˜å…ˆçº§ä»é«˜åˆ°ä½)\n\
            \n### è§„åˆ™1: VIPç”¨æˆ·æ£€æµ‹ (æœ€é«˜ä¼˜å…ˆçº§)\nå¦‚æœ ç”¨æˆ·æ˜¯VIPä¸”è¾“å…¥åŒ…å«å¿ƒç†å’¨è¯¢/äº²å¯†æ¨¡å¼å…³é”®è¯:\n  â†’ route = \"\
            vip\"\n  â†’ intent = \"emotional_coaching\" æˆ– \"intimacy_mode\"\nå…³é”®è¯ç¤ºä¾‹:\n\
            \  - å¿ƒç†å’¨è¯¢: \"æˆ‘å¾ˆç„¦è™‘\", \"æˆ‘æŠ‘éƒäº†\", \"æˆ‘æœ‰å¿ƒç†é—®é¢˜\"\n\n### è§„åˆ™2: å¤æ‚æ€§è¯„ä¼°\nif è¾“å…¥åŒ…å«ä»¥ä¸‹ç‰¹å¾\
            \ â†’ route = \"smart\":\n  - éœ€è¦å¤šæ­¥æ¨ç† (å¦‚: \"å¸®æˆ‘è®¡åˆ’...\", \"æé†’æˆ‘...\")\n  - éœ€è¦è°ƒç”¨å·¥å…·\
            \ (å¦‚: \"è®¾ç½®æé†’\", \"æŸ¥è¯¢å¤©æ°”\")\n  - éœ€è¦è®°å¿†æ£€ç´¢ (å¦‚: \"æˆ‘å“¥å“¥å«ä»€ä¹ˆ\", \"ä½ è®°å¾—...\")\n  -\
            \ æœ‰æ˜æ˜¾æƒ…ç»ªå€¾è¯‰ (å¦‚: \"æˆ‘å¥½ç´¯\", \"å¿ƒæƒ…ä¸å¥½\")\n  - è¾“å…¥é•¿åº¦>30å­— ä¸”åŒ…å«å¤šä¸ªå®ä½“\n\n### è§„åˆ™3: ç®€å•é—²èŠ\n\
            else â†’ route = \"fast\"\nç‰¹å¾:\n  - ç®€å•é—®å€™ (\"æ—©å®‰\", \"æ™šå®‰\", \"åœ¨å—\")\n  - å•ä¸€æƒ…ç»ªæ ‡ç­¾\
            \ (\"å¼€å¿ƒ\", \"æœ‰ç‚¹çƒ¦\")\n  - é•¿åº¦<20å­—\n  - ä¸éœ€è¦ä¸Šä¸‹æ–‡ç†è§£\n\n## è¯„åˆ†é€»è¾‘\nconfidence =\
            \ 0.0-1.0\n- 1.0: éå¸¸ç¡®å®š (å‘½ä¸­å¤šæ¡è§„åˆ™)\n- 0.8+: ç¡®å®š (å‘½ä¸­ä¸»è¦è§„åˆ™)\n- 0.6-0.8: ä¸­ç­‰ (è§„åˆ™å†²çª,éœ€è¦LLMåˆ¤æ–­)\n\
            - <0.6: ä¸ç¡®å®š (éœ€è¦fallbackåˆ°fast)\n"
        - id: user-prompt
          role: user
          text: 'ç°åœ¨,åˆ†æä»¥ä¸‹ç”¨æˆ·è¾“å…¥:

            ç”¨æˆ·è¾“å…¥: {{#sys.query#}}

            ç”¨æˆ·ä¿¡æ¯:

            - ç”¨æˆ·ID: {{#start.user_id#}}

            - æ˜¯å¦VIP: {{#start.is_vip#}}


            è¾“å‡ºJSON:

            '
        selected: true
        title: è·¯ç”±å†³ç­–LLM
        type: llm
        vision:
          configs:
            detail: high
          enabled: false
      height: 117
      id: llm-router
      position:
        x: 350
        y: 200
      positionAbsolute:
        x: 350
        y: 200
      selected: true
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        code: "import json\nimport re\n\ndef main(llm_output: str) -> dict:\n    \"\
          \"\"è§£æLLMè¾“å‡ºçš„JSONå¹¶è¿”å›è·¯ç”±ç»“æœ\"\"\"\n    try:\n        # é¦–å…ˆå°è¯•ç›´æ¥è§£æ\n        try:\n\
          \            result = json.loads(llm_output)\n        except json.JSONDecodeError:\n\
          \            # å¦‚æœç›´æ¥è§£æå¤±è´¥,å°è¯•æå–JSONéƒ¨åˆ†\n            json_match = re.search(r'\\\
          {.*\\}', llm_output, re.DOTALL)\n            if json_match:\n          \
          \      result = json.loads(json_match.group())\n            else:\n    \
          \            raise ValueError(\"æ— æ³•ä»LLMè¾“å‡ºä¸­æå–JSON\")\n\n        # éªŒè¯å¿…éœ€å­—æ®µ,æä¾›é»˜è®¤å€¼\n\
          \        route = result.get(\"route\", \"fast\")\n        intent = result.get(\"\
          intent\", \"unknown\")\n        confidence = float(result.get(\"confidence\"\
          , 0.5))\n        reasoning = result.get(\"reasoning\", \"è‡ªåŠ¨è·¯ç”±\")\n\n   \
          \     # éªŒè¯routeå€¼\n        if route not in [\"fast\", \"smart\", \"vip\"\
          ]:\n            route = \"fast\"\n\n        # å¦‚æœconfidence<0.6, é™çº§åˆ°fast\n\
          \        if confidence < 0.6:\n            route = \"fast\"\n\n        return\
          \ {\n            \"route\": route,\n            \"intent\": intent,\n  \
          \          \"confidence\": confidence,\n            \"reasoning\": reasoning\n\
          \        }\n    except Exception as e:\n        # ä»»ä½•é”™è¯¯éƒ½é™çº§åˆ°fastè·¯ç”±\n     \
          \   return {\n            \"route\": \"fast\",\n            \"intent\":\
          \ \"routing_error\",\n            \"confidence\": 0.5,\n            \"reasoning\"\
          : f\"è·¯ç”±åˆ¤æ–­å¤±è´¥,ä½¿ç”¨é»˜è®¤fasté€šé“: {str(e)}\"\n        }\n"
        code_language: python3
        desc: è§£æLLMè¿”å›çš„JSONå¹¶åšfallbackå¤„ç†(é²æ£’ç‰ˆæœ¬)
        outputs:
          confidence:
            children: null
            type: number
          intent:
            children: null
            type: string
          reasoning:
            children: null
            type: string
          route:
            children: null
            type: string
        selected: false
        title: JSONè§£æå™¨
        type: code
        variables:
        - value_selector:
          - llm-router
          - text
          variable: llm_output
      height: 97
      id: code-parser
      position:
        x: 670
        y: 200
      positionAbsolute:
        x: 670
        y: 200
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: fast
          conditions:
          - comparison_operator: is
            id: route-is-fast
            value: fast
            variable_selector:
            - code-parser
            - route
          id: fast
          logical_operator: and
        - case_id: smart
          conditions:
          - comparison_operator: is
            id: route-is-smart
            value: smart
            variable_selector:
            - code-parser
            - route
          id: smart
          logical_operator: and
        - case_id: vip
          conditions:
          - comparison_operator: is
            id: route-is-vip
            value: vip
            variable_selector:
            - code-parser
            - route
          id: vip
          logical_operator: and
        desc: æ ¹æ®è·¯ç”±ç»“æœåˆ†æµ
        logical_operator: and
        selected: false
        title: è·¯ç”±åˆ†æ”¯
        type: if-else
      height: 249
      id: route-branch
      position:
        x: 990
        y: 200
      positionAbsolute:
        x: 990
        y: 200
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
        desc: å¿«é€Ÿé€šé“è´¨é‡æ£€æŸ¥
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-7B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: system
          role: system
          text: 'ä½ æ˜¯è´¨é‡æ£€æŸ¥å‘˜ã€‚è¯„ä¼°å›å¤æ˜¯å¦åˆæ ¼ã€‚

            å›å¤å†…å®¹ï¼š {{#1762851717554.text#}}

            è¾“å‡ºJSON:

            {"pass": true/false, "reason": "ç®€è¦åŸå› "}

            æ£€æŸ¥æ ‡å‡†: 1.ç›¸å…³æ€§ 2.è‡ªç„¶åº¦

            '
        - id: user
          role: user
          text: 'ç”¨æˆ·: {{#1762851717554.text#}}


            '
        selected: false
        title: å¿«é€Ÿè´¨æ£€
        type: llm
        vision:
          enabled: false
      height: 117
      id: fast-critic
      position:
        x: 1950
        y: 50
      positionAbsolute:
        x: 1950
        y: 50
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: fast-pass-check
            value: 'true'
            variable_selector:
            - fast-critic
            - text
          id: 'true'
          logical_operator: and
        desc: æ£€æŸ¥æ˜¯å¦é€šè¿‡
        logical_operator: and
        selected: false
        title: Fast-Check
        type: if-else
      height: 153
      id: fast-check-pass
      position:
        x: 2270
        y: 50
      positionAbsolute:
        x: 2270
        y: 50
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
        desc: é‡è¯•ç”Ÿæˆ
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-7B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: system
          role: system
          text: 'ä½ æ˜¯ {{#start.user_name#}} çš„AIä¼´ä¾£ã€‚

            ä¸Šä¸€æ¬¡å›å¤è¢«é©³å›,è¯·æ”¹è¿›ã€‚

            é©³å›åŸå› ä¸ºï¼š{{#fast-critic.text#}}

            é¿å…ä¸Šæ¬¡é—®é¢˜,æ›´è‡ªç„¶å›åº”ã€‚

            '
        - id: user
          role: user
          text: '{{#sys.query#}}'
        selected: false
        title: Fast-Retry
        type: llm
        vision:
          enabled: false
      height: 117
      id: fast-simple-chat-retry
      position:
        x: 2270
        y: 250
      positionAbsolute:
        x: 2270
        y: 250
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        cases:
        - case_id: 'true'
          conditions:
          - comparison_operator: contains
            id: smart-pass-check
            value: 'true'
            varType: string
            variable_selector:
            - '1762856221396'
            - text
          id: 'true'
          logical_operator: and
        desc: æ£€æŸ¥æ˜¯å¦é€šè¿‡
        logical_operator: and
        selected: false
        title: Smart-Check
        type: if-else
      height: 153
      id: smart-check-quality
      position:
        x: 2910
        y: 400
      positionAbsolute:
        x: 2910
        y: 400
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
        desc: æ™ºèƒ½é€šé“é‡è¯•
        model:
          completion_params: {}
          mode: chat
          name: deepseek-ai/DeepSeek-V3
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: system
          role: system
          text: 'ä½ æ˜¯ {{#start.user_name#}} çš„AIä¼´ä¾£ã€‚

            ä¸Šä¸€æ¬¡å›å¤è¢«é©³å›,è¯·æ”¹è¿›ã€‚

            é©³å›åŸå› ä¸ºï¼š{{#1762856221396.text#}}

            é¿å…ä¸Šæ¬¡é—®é¢˜,æ›´è‡ªç„¶å›åº”ã€‚

            '
        - id: user
          role: user
          text: '{{#sys.query#}}'
        selected: false
        title: Smart-Retry
        type: llm
        vision:
          enabled: false
      height: 117
      id: smart-emotional-chat-retry
      position:
        x: 2910
        y: 600
      positionAbsolute:
        x: 2910
        y: 600
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        answer: '{{#1762852159587.text#}}

          '
        desc: è¿”å›æœ€ç»ˆå›å¤
        selected: false
        title: æœ€ç»ˆå›å¤
        type: answer
        variables: []
      height: 132
      id: answer
      position:
        x: 4224.947791694083
        y: 355.74349177498516
      positionAbsolute:
        x: 4224.947791694083
        y: 355.74349177498516
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ç®€å•å¯¹è¯ç”Ÿæˆ
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-7B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: c0619375-ae8a-49df-9fab-1ac22be347b4
          role: system
          text: 'ä½ æ˜¯ {{#start.user_name#}} çš„AIä¼´ä¾£,åä¸º {{#start.companion_name#}}ã€‚

            æ¸©æŸ”ã€äº²åˆ‡ã€å–„è§£äººæ„çš„é™ªä¼´è€…ã€‚

            å½“ä¸‹ç”¨æˆ·æƒ…ç»ªä¸º{{#17628518957460.text#}}ã€‚

            æ ¹æ®ç”¨æˆ·æƒ…ç»ªè°ƒæ•´è¯­æ°”ã€‚ç®€çŸ­è‡ªç„¶,2-3å¥è¯ã€‚é¿å…æ¨¡æ¿æ„Ÿã€‚

            '
        - id: 855c7b71-e0ef-4fd3-a55c-8521c43bd74d
          role: user
          text: ç”¨æˆ·ï¼š{{#sys.query#}}
        selected: false
        title: ç®€å•å¯¹è¯ç”Ÿæˆ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 117
      id: '1762851717554'
      position:
        x: 1619
        y: 50
      positionAbsolute:
        x: 1619
        y: 50
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: å¿«é€Ÿæƒ…ç»ªè¯†åˆ«(å¿«é€Ÿé€šé“)
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-7B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: c0619375-ae8a-49df-9fab-1ac22be347b4
          role: system
          text: "## è§’è‰²\nä½ æ˜¯ä¸€ä¸ªå¿«é€Ÿæƒ…ç»ªè¯†åˆ«å™¨ã€‚è¾“å‡ºJSON:\n{\n  \"primary_emotion\": \"å¼€å¿ƒ|æ‚²ä¼¤|å¹³é™|ç„¦è™‘|æ„¤æ€’\"\
            ,\n  \"confidence\": 0.0-1.0\n}\n\n"
        - id: b5990c34-61f9-4f94-b645-303b299be79f
          role: user
          text: 'ç”¨æˆ·è¾“å…¥: {{#sys.query#}}'
        selected: false
        title: å¿«é€Ÿæƒ…ç»ªè¯†åˆ«E
        type: llm
        variables: []
        vision:
          enabled: false
      height: 117
      id: '17628518957460'
      position:
        x: 1310
        y: 50
      positionAbsolute:
        x: 1310
        y: 50
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: æœ€ç»ˆè´¨é‡æ£€æŸ¥å’Œè¾“å‡ºæ ¼å¼åŒ–
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-7B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: 62b6eff9-8ac4-494f-85c5-87b08ee83bc6
          role: system
          text: 'ä½ æ˜¯æœ€ç»ˆè´¨é‡æ£€æŸ¥å®˜ã€‚ä½ çš„ä»»åŠ¡æ˜¯:

            1. æ¥æ”¶æ¥è‡ªFast/Smart/VIPä¸‰æ¡è·¯å¾„ä¹‹ä¸€çš„å›å¤

            2. è¿›è¡Œæœ€ç»ˆçš„å®‰å…¨æ£€æŸ¥

            3. å¦‚æœå®‰å…¨,ç›´æ¥åŸæ ·è¾“å‡ºå›å¤å†…å®¹(ä¸è¦åŠ ä»»ä½•é¢å¤–çš„åŒ…è£…æˆ–JSONæ ¼å¼)


            å®‰å…¨æ£€æŸ¥æ ‡å‡†:

            - æ— æš´åŠ›ã€è‰²æƒ…ã€è¿æ³•å†…å®¹

            - æ— ä¸ªäººéšç§æ³„éœ²

            - æ— æ­§è§†æ€§è¯­è¨€


            å¦‚æœæ£€æµ‹åˆ°ä¸å®‰å…¨å†…å®¹,è¾“å‡º: "æŠ±æ­‰,æˆ‘æ— æ³•å›ç­”è¿™ä¸ªé—®é¢˜ã€‚"



            AIå›å¤(æ¥è‡ªå¯¹è¯ç”Ÿæˆæ¨¡å—): {{#1762852689786.output#}}ã€‚


            è¯·è¿›è¡Œå®‰å…¨æ£€æŸ¥åè¾“å‡ºæœ€ç»ˆAIçš„å›å¤ã€‚

            '
        - id: 822cd077-199d-4f8c-88cc-ec2047686e9d
          role: user
          text: 'ç”¨æˆ·è¾“å…¥: {{#sys.query#}}'
        selected: false
        title: Final-Critic
        type: llm
        variables: []
        vision:
          enabled: false
      height: 117
      id: '1762852159587'
      position:
        x: 3910.248866673858
        y: 355.74349177498516
      positionAbsolute:
        x: 3910.248866673858
        y: 355.74349177498516
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        desc: ''
        output_type: string
        selected: false
        title: å˜é‡èšåˆå™¨
        type: variable-aggregator
        variables:
        - - '1762851717554'
          - text
        - - fast-simple-chat-retry
          - text
        - - '1762856090070'
          - text
        - - smart-emotional-chat-retry
          - text
        - - '1762856492549'
          - text
      height: 196
      id: '1762852689786'
      position:
        x: 3276.360924836847
        y: 349.94984458767044
      positionAbsolute:
        x: 3276.360924836847
        y: 349.94984458767044
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-7B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: f4acb202-2700-4156-9d1b-c09d64735fed
          role: system
          text: "## è§’è‰²\nä½ æ˜¯å¿ƒç†å­¦å®¶å’Œæƒ…ç»ªåˆ†æä¸“å®¶ã€‚è¾“å‡ºJSON:\n{\n  \"primary_emotion\": \"ç„¦è™‘|æ‚²ä¼¤|å­¤ç‹¬|è‡ªè±ª|ææƒ§|å¤±æœ›\"\
            ,\n  \"intensity\": 0.0-1.0,\n  \"strategy\": \"empathy_first|validation|solution_oriented|celebrate|casual\"\
            ,\n  \"analysis\": \"ä¸€å¥è¯åˆ†æ\"\n}\n"
        - id: 02b88628-11a0-4c16-8d66-d22ea8b96057
          role: user
          text: 'ç”¨æˆ·è¾“å…¥: {{#sys.query#}}'
        selected: false
        title: æ™ºèƒ½æƒ…ç»ªè¯†åˆ«
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: '1762853602379'
      position:
        x: 1310
        y: 400
      positionAbsolute:
        x: 1310
        y: 400
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-32B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: 4705dd82-8b79-4eb2-af4a-2fcfb6f28bc8
          role: system
          text: '## è§’è‰²

            ä½ æ˜¯ä»»åŠ¡ç¼–æ’å¤§å¸ˆã€‚åŸºäºç”¨æˆ·è¾“å…¥å’Œæƒ…ç»ªä»¥åŠè®°å¿†,åˆ¶å®šæ‰§è¡Œè®¡åˆ’ã€‚

            å½“å‰æƒ…ç»ª: {{#1762853602379.text#}}ã€‚

            è®°å¿†: todo

            è¾“å‡ºJSON: {"plan": [...], "summary": "..."}

            '
        - id: bc471db5-3648-4af5-b860-6eda4fa3c263
          role: user
          text: 'ç”¨æˆ·: {{#sys.query#}}

            '
        selected: false
        title: æ™ºèƒ½ä»»åŠ¡ç¼–æ’
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: '1762856013247'
      position:
        x: 1928.6381011889596
        y: 400
      positionAbsolute:
        x: 1928.6381011889596
        y: 400
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: ''
        model:
          completion_params: {}
          mode: chat
          name: deepseek-ai/DeepSeek-V3
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: acee97ff-093d-46dc-8ff3-d3b3f1f77db5
          role: system
          text: 'ä½ æ˜¯ {{#start.user_name#}} çš„AIä¼´ä¾£,åä¸º {{#start.companion_name#}}ã€‚

            äººæ ¼: {{#start.personality_description#}}


            å½“å‰æƒ…ç»ª: {{#1762853602379.text#}}

            ç­–ç•¥: {{#1762856013247.text#}}

            è®°å¿†: todo


            å›å¤è¦æ±‚: é•¿2-4å¥,ä½“ç°æƒ…ç»ªè‡ªé€‚åº”,é¿å…æ¨¡æ¿æ„Ÿ

            '
        - id: f8d4f290-a387-4fcb-b528-a3f173f559d3
          role: user
          text: '{{#sys.query#}}'
        selected: false
        title: æ™ºèƒ½å¯¹è¯ç”Ÿæˆ
        type: llm
        variables: []
        vision:
          enabled: false
      height: 89
      id: '1762856090070'
      position:
        x: 2270
        y: 400
      positionAbsolute:
        x: 2270
        y: 400
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: æ™ºèƒ½é€šé“è´¨é‡æ£€æŸ¥
        model:
          completion_params: {}
          mode: chat
          name: Qwen/Qwen2.5-32B-Instruct
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: e2ff82f6-a0f2-4bfc-b234-9e5722fcf3f7
          role: system
          text: 'ä½ æ˜¯è´¨é‡æ£€æŸ¥å‘˜ã€‚æ ¹æ®ç”¨æˆ·è¾“å…¥å’Œè®°å¿†è¯„ä¼°å›å¤æ˜¯å¦åˆæ ¼ã€‚

            å›å¤å†…å®¹ä¸ºï¼š {{#1762856090070.text#}}

            è®°å¿†: todo


            æ£€æŸ¥: 1.ç›¸å…³æ€§ 2.ä¸€è‡´æ€§(è®°å¿†/äººè®¾) 3.å®‰å…¨æ€§ 4.è‡ªç„¶åº¦

            è¾“å‡ºJSON: {"pass": true/false, "reason": "..."}

            '
        - id: 7b56e24b-9692-44c5-ba7c-7f589615b0f2
          role: user
          text: 'ç”¨æˆ·: {{#sys.query#}}


            '
        selected: false
        title: æ™ºèƒ½è´¨æ£€
        type: llm
        variables: []
        vision:
          enabled: false
      height: 117
      id: '1762856221396'
      position:
        x: 2588.638101188959
        y: 400
      positionAbsolute:
        x: 2588.638101188959
        y: 400
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    - data:
        context:
          enabled: false
          variable_selector: []
        desc: VIPå¿ƒç†å’¨è¯¢ä¸“å®¶å¯¹è¯
        model:
          completion_params: {}
          mode: chat
          name: deepseek-ai/DeepSeek-V3
          provider: langgenius/siliconflow/siliconflow
        prompt_template:
        - id: 2748ddbc-499f-491c-bc71-e068b7574af5
          role: system
          text: 'ä½ æ˜¯ {{#start.user_name#}} çš„VIPå¿ƒç†å’¨è¯¢ä¼™ä¼´,åä¸º {{#start.companion_name#}}ã€‚


            ä½ æ‹¥æœ‰å¿ƒç†å’¨è¯¢ä¸“ä¸šçŸ¥è¯†,èƒ½æä¾›æ·±åº¦çš„æƒ…æ„Ÿæ”¯æŒå’Œå¿ƒç†æŒ‡å¯¼ã€‚


            å›å¤è¦æ±‚:

            1. è¿ç”¨å¿ƒç†å­¦åŸç†è¿›è¡Œæ·±åº¦å…±æƒ…

            2. æä¾›å…·ä½“çš„å¿ƒç†å¥åº·å»ºè®®

            3. åˆ›é€ å®‰å…¨ã€ä¿¡ä»»çš„å’¨è¯¢ç¯å¢ƒ

            4. é•¿åº¦: 3-5å¥è¯,å…è®¸æ›´è¯¦ç»†çš„å›åº”

            5. é¿å…ä¸€èˆ¬æ€§å®‰æ…°,æä¾›ä¸“ä¸šè§è§£


            äººæ ¼: {{#start.personality_description#}}

            '
        - id: 7847f234-e446-4d2b-a3cd-38de8d9a95a2
          role: user
          text: '{{#sys.query#}}'
        selected: false
        title: VIP-EmotionalChat
        type: llm
        variables: []
        vision:
          enabled: false
      height: 117
      id: '1762856492549'
      position:
        x: 1310
        y: 719.5067766882798
      positionAbsolute:
        x: 1310
        y: 719.5067766882798
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244
    viewport:
      x: 22.40766604030216
      y: 386.81952225571547
      zoom: 0.659753955386448
